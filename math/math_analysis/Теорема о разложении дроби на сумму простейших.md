[[Рациональная дробь]]
[[Теорема о разложении многочлена над R]]
[[Простейшая дробь]]
#### Формулировка
Пусть $\frac{P_n(x)}{Q_m(x)}$ - рациональная дробь, причём
$$Q_n(x) = (x-a_1)^{k_1}\cdot\ldots\cdot(x-a_p)^{k_p}\cdot(x^2+p_1x+q_1)^{l_1}\cdot\ldots\cdot(x^2+p_mx+q_m)^{l_m},$$
$$\forall i \in \{1, \ldots, p\}\ a_i \in \mathbb R, k_i \in \mathbb N,\quad \forall j \in \{1, \ldots, m\}\ l_j \in \mathbb N, p_j^2-4q_j < 0, $$
Тогда существует разложение вида
$$\frac{P_n(x)}{Q_m(x)} = R_{n-m}(x) + \sum\limits_{i=1}^{p}\sum\limits_{j=1}^{k_i}\frac{A_{ij}}{(x-a_{i})^{k_i - j + 1}} + \sum\limits_{i=1}^{m}\sum\limits_{j=1}^{l_i}\frac{B_{ij}x + C_{ij}}{(x^2+p_ix+q_i)^{l_i - j + 1}}$$
где $A_{ij}, B_{ij}, C_{ij} \in \mathbb R$. 
>[!info]+ Смысл
>Любую рациональную дробь мы можем разложить на сумму простейших дробей, что очень поможет нам при интегрировании.
#### Доказательство
Пусть $n > m$. Тогда, по [[Лемма о делении с остатком рациональной дроби]], дробь можно представить в таком виде
$$\frac{P_n(x)}{Q_m(x)} = R_{n-m}(x) + \frac{T_k(x)}{Q_m(x)}$$
Таким образом, достаточно рассмотреть случай, когда исходная дробь является [[Правильная рациональная дробь|правильной]] и не сократимой. 
По [[Лемма о дробях первого типа]], можно найти число $A_{11}$ и многочлен $\widetilde P^{1k_1}(x)$ такие, что
$$\frac{P_n(x)}{Q_m(x)} = \frac{A_{11}}{(x-a_1)^{k_1}} + \frac{\widetilde P^{(11)}(x)}{(x-a_1)^{k_1-1}\widetilde Q^{(1)}},$$
где $$\widetilde Q^{(1)} = (x-a_2)^{k_2}\cdot\ldots\cdot(x-a_p)^{k_p}\cdot(x^2+p_1x+q_1)^{l_1}\cdot\ldots\cdot(x^2+p_mx+q_m)^{l_m}$$
По той же самой лемме, мы можем повторить подобное разбиение 
$$\frac{\widetilde P^{(1k_1)}(x)}{(x-a_1)^{k_1-1}\widetilde Q^{(1)}} = \frac{A_{12}}{(x-a_1)^{k_1-1}} + \frac{\widetilde P^{(12)}}{(x-a_1)^{k_1-2}\widetilde Q^{(1)}(x)}$$
Продолжая аналогичные разбиения получим
$$\frac{P_n(x)}{Q_m(x)} = \frac{A_{11}}{(x-a_1)^{k_1}} + \frac{A_{12}}{(x-a_1)^{k_{1}-1}} + \ldots + \frac{A_{1k_1}}{x-a_1} + \frac{\widetilde P^{(1k_1)}}{\widetilde Q^{(1)}(x)}$$
Повторим все те же действия для всех корней $a_i$ кратности $k_i$ $\forall i \in \{1, \ldots, p\}$ и получим
$$\frac{P_n(x)}{Q_m(x)} = \sum\limits_{i=1}^{p}\sum\limits_{j=1}^{k_i}\frac{A_{ij}}{(x-a_i)^{k_i - j+1}} + \frac{\widetilde P^{(pk_p)}}{\widetilde Q^{(p)}(x)},$$
где $$\widetilde Q^{(p)}(x) = (x^2+p_1x+q_1)^{l_1}\cdot\ldots\cdot(x^2+p_mx+q_m)^{l_m}$$
и дробь $\frac{\widetilde P^{(pk_p)}}{\widetilde Q^{(p)}(x)}$ - [[Правильная рациональная дробь]], так как если мы будем приводить слагаемые под один знаменатель, то мы будет умножать и числитель, и знаменатель на одни и те же одночлены. По итогу получим степень, как у исходной дроби, которую мы разбивали, а она является правильной.
Дальше, по [[Лемма о дробях второго типа]], получим
$$\frac{\widetilde P^{(pk_p)}}{\widetilde Q^{(p)}(x)} = \frac{B_{11}x + C_{11}}{(x^2+p_1x+q_1)^{l_1}} + \frac{\widehat P^{(11)}}{(x^2+p_1x+q_1)^{l_1-1}\widehat Q^{(1)}(x)},$$
где $$\widehat Q^{(1)}(x) = (x^2+p_2x+q_2)^{l_2}\cdot\ldots\cdot(x^2+p_mx+q_m)^{l_m}$$
Продолжая подобные действия, как выше, только используя вторую лемму, придём к разложению
$$\frac{\widetilde P^{(pk_p)}}{\widetilde Q^{(p)}(x)} = \sum\limits_{i=1}^{m}\sum\limits_{j=1}^{l_i}\frac{B_{ij}x+C_{ij}}{(x^2+p_ix+q_i)^{l_i - j + 1}}$$
Следовательно, получаем конечное разложение в виде
$$\frac{P_n(x)}{Q_m(x)} = \sum\limits_{i=1}^{p}\sum\limits_{j=1}^{k_i}\frac{A_{ij}}{(x-a_i)^{k_i-j+1}} + \sum\limits_{i=1}^{m}\sum\limits_{j=1}^{l_i}\frac{B_{ij}x+C_{ij}}{(x^2+p_ix+q_i)^{l_i-j+1}}$$
Что и требовалось доказать.